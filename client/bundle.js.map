{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://bombattack/./client/js/helpers/elements.js","webpack://bombattack/./client/js/states/boot.js","webpack://bombattack/./client/js/states/preload.js","webpack://bombattack/./client/js/states/menu.js","webpack://bombattack/./client/js/utils/constants.js","webpack://bombattack/./client/js/states/select_map.js","webpack://bombattack/./client/js/states/pending_game.js","webpack://bombattack/./client/js/utils/utils.js","webpack://bombattack/./client/js/entities/info.js","webpack://bombattack/./client/js/entities/player.js","webpack://bombattack/./client/js/entities/enemy_player.js","webpack://bombattack/./client/js/entities/bomb.js","webpack://bombattack/./client/js/entities/spoil.js","webpack://bombattack/./client/js/entities/fire_blast.js","webpack://bombattack/./client/js/entities/bone.js","webpack://bombattack/./client/js/states/play.js","webpack://bombattack/./client/js/states/win.js","webpack://bombattack/./client/js/app.js"],"sourcesContent":["export class Text extends Phaser.Text {\n\n  constructor({ game, x, y, text, style }) {\n    super(game, x, y, text, style);\n    this.anchor.setTo(0.5);\n\n    this.game.add.existing(this);\n  }\n\n}\n\nexport class Button extends Phaser.Button {\n\n  constructor({ game, x, y, asset, callback, callbackContext, overFrame, outFrame, downFrame, upFrame }) {\n    super(game, x, y, asset, callback, callbackContext, overFrame, outFrame, downFrame, upFrame);\n    this.anchor.setTo(0.5);\n\n    this.game.add.existing(this);\n  }\n\n}\n\nexport class TextButton extends Phaser.Button {\n\n  constructor({ game, x, y, asset, callback, callbackContext, overFrame, outFrame, downFrame, upFrame, label, style }) {\n    super(game, x, y, asset, callback, callbackContext, overFrame, outFrame, downFrame, upFrame);\n    this.anchor.setTo(0.5);\n\n    this.text = new Phaser.Text(this.game, 0, 0, label, style);\n    this.text.anchor.setTo(0.5);\n\n    this.addChild(this.text);\n\n    this.game.add.existing(this);\n  }\n\n  disable() {\n    this.setFrames(3, 3);\n    this.inputEnabled = false;\n    this.input.useHandCursor = false;\n  }\n\n  enable() {\n    this.setFrames(1, 0, 2);\n    this.inputEnabled = true;\n    this.input.useHandCursor = true;\n  }\n\n}\n\nexport class GameSlots extends Phaser.Group {\n\n  constructor({ game, availableGames, callback, callbackContext, x, y, style }) {\n    super(game);\n\n    let game_slot_asset = 'slot_backdrop'\n    let game_enter_asset = 'list_icon'\n\n    let yOffset = y;\n\n    for (let availableGame of availableGames) {\n      let gameBox = new Phaser.Image(this.game, x, yOffset, game_slot_asset)\n      let button = new Phaser.Button(this.game, gameBox.width - 100, 12, game_enter_asset, callback.bind(callbackContext, { game_id: availableGame.id }), null, 1, 0, 2, 1);\n      let text = new Phaser.Text(this.game, 30, 25, `Join Game: ${availableGame.name}`, style);\n\n      gameBox.addChild(button);\n      gameBox.addChild(text);\n\n      this.add(gameBox);\n\n      yOffset += 105;\n    }\n  }\n\n  destroy() {\n    this.callAll('kill') // destroy\n  }\n}\n\nexport class PlayerSlots extends Phaser.Group {\n\n  constructor({ game, max_players, players, x, y, asset_empty, asset_player, style }) {\n    super(game);\n\n    let xOffset = x;\n\n    for (let i = 0; i < max_players; i++) {\n      let slotBox\n      let slotName\n      let _player = players[i]\n\n      if (_player) {\n        slotBox = new Phaser.Image(this.game, xOffset, y, asset_player+_player.skin)\n        slotName = new Phaser.Text(this.game, slotBox.width/2, slotBox.height + 15, _player.skin, style);\n        slotName.anchor.setTo(0.5);\n        slotBox.addChild(slotName);\n      } else {\n        slotBox = new Phaser.Image(this.game, xOffset, y, asset_empty)\n      }\n\n      this.add(slotBox);\n      xOffset += 170;\n    }\n  }\n\n  destroy() {\n    this.callAll('kill')\n  }\n}\n\nexport class SpoilNotification extends Phaser.Group {\n\n  constructor({ game, asset, x, y }) {\n    super(game)\n\n    this.picture = new Phaser.Image(this.game, x, y - 20, asset);\n    this.picture.anchor.setTo(0.5);\n\n    this.add(this.picture);\n\n    this.tween = this.game.add.tween(this.picture);\n    this.tween.to({ y: this.picture.y - 25, alpha: 0 }, 600);\n\n    this.tween.onComplete.add(this.finish, this);\n\n    this.tween.start()\n  }\n\n  finish() {\n    this.callAll('kill')\n  }\n}\n","import { Text } from '../helpers/elements';\n\nclass Boot extends Phaser.State {\n\n  create() {\n    // Make the game keep reacting to messages from the server even when the game window doesn’t have focus.\n    // The game pauses when I open a new tab in the same window, but does not pause when I focus on another application\n    this.game.stage.disableVisibilityChange = true;\n\n    // Responsive scaling (stable on mobile, keeps aspect ratio)\n    // SHOW_ALL avoids distortion and keeps input coordinates consistent.\n    // It may add letterboxing on some aspect ratios, but gameplay + touch controls remain reliable.\n    this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;\n    this.game.scale.pageAlignHorizontally = true;\n    this.game.scale.pageAlignVertically = true;\n\n    const refresh = () => {\n      try { this.game.scale.refresh(); } catch (_) {}\n    };\n\n    window.addEventListener('resize', refresh);\n    refresh();\n\n    new Text({\n      game: this.game,\n      x: this.game.world.centerX,\n      y: this.game.world.centerY,\n      text: 'Loading...',\n      style: {\n        font: '30px Areal',\n        fill: '#FFFFFF'\n      }\n    })\n\n    // Mobile browsers often block audio until a user gesture.\n    // Unlock/resume audio on first tap/click.\n    try {\n      this.game.sound.mute = false;\n      this.game.input.onDown.addOnce(() => {\n        try {\n          if (this.game.sound && this.game.sound.context && this.game.sound.context.state === 'suspended') {\n            this.game.sound.context.resume();\n          }\n          if (this.game.sound && this.game.sound.unlock) {\n            this.game.sound.unlock();\n          }\n        } catch (_) {}\n      });\n    } catch (_) {}\n\n    this.state.start('Preload');\n  }\n\n}\n\nexport default Boot;\n","class Preload extends Phaser.State {\n\n  preload() {\n    // Debug loader issues on mobile (use ?debug=1)\n    try {\n      this.load.onFileError.add((key, file) => {\n        try { if (window.UK01Log) window.UK01Log(`LOAD_ERR key=${key} url=${file && file.url}`); } catch (_) {}\n      });\n      this.load.onFileComplete.add((progress, key) => {\n        try {\n          if (window.UK01Loading) window.UK01Loading.set(progress, `載入中：${key}`);\n          if (window.UK01Log && progress < 100) window.UK01Log(`LOAD ${progress}% ${key}`);\n        } catch (_) {}\n      });\n      this.load.onLoadComplete.add(() => {\n        try {\n          if (window.UK01Loading) window.UK01Loading.set(100, '完成');\n          if (window.UK01Log) window.UK01Log('LOAD_DONE');\n        } catch (_) {}\n      });\n    } catch (_) {}\n    // Menu:\n    this.load.image('main_menu',     'images/menu/main_menu.png');\n    this.load.image('slot_backdrop', 'images/menu/slot_backdrop.png');\n\n    this.load.spritesheet('buttons',    'images/menu/buttons.png', 200, 75);\n    this.load.spritesheet('check_icon', 'images/menu/accepts.png', 75, 75);\n    this.load.spritesheet('list_icon',  'images/menu/game_enter.png', 75, 75);\n\n    this.load.image('hot_map_preview',   'images/menu/hot_map_preview.png');\n    this.load.image('cold_map_preview',  'images/menu/cold_map_preview.png');\n    // cache-bust to ensure clients fetch the updated preview\n    this.load.image('arena_map_preview', 'images/menu/arena_map_preview.png?v=2');\n    // cache-bust to ensure clients fetch the updated preview\n    this.load.image('open_map_preview',  'images/menu/open_map_preview.png?v=3');\n    this.load.image('rune_lab_preview',  'images/menu/rune_lab_preview.png?v=1');\n    this.load.image('mirror_temple_preview', 'images/menu/mirror_temple_preview.png?v=1');\n    this.load.image('trap_garden_preview', 'images/menu/trap_garden_preview.png?v=1');\n    this.load.image('prev',             'images/menu/left_arrow.png');\n    this.load.image('next',             'images/menu/right_arrow.png');\n\n    // Map:\n    this.load.image('tiles',      'maps/tileset.png');\n    this.load.tilemap('hot_map',   'maps/hot_map.json', null, Phaser.Tilemap.TILED_JSON);\n    this.load.tilemap('cold_map',  'maps/cold_map.json', null, Phaser.Tilemap.TILED_JSON);\n    this.load.tilemap('arena_map', 'maps/arena_map.json', null, Phaser.Tilemap.TILED_JSON);\n    this.load.tilemap('open_map',  'maps/open_map.json',  null, Phaser.Tilemap.TILED_JSON);\n    this.load.tilemap('rune_lab',  'maps/rune_lab.json',  null, Phaser.Tilemap.TILED_JSON);\n    this.load.tilemap('mirror_temple',  'maps/mirror_temple.json',  null, Phaser.Tilemap.TILED_JSON);\n    this.load.tilemap('trap_garden',  'maps/trap_garden.json',  null, Phaser.Tilemap.TILED_JSON);\n\n\n    // Game:\n    this.load.spritesheet('explosion_center',     'images/game/explosion_center.png',     35, 35);\n    this.load.spritesheet('explosion_horizontal', 'images/game/explosion_horizontal.png', 35, 35);\n    this.load.spritesheet('explosion_vertical',   'images/game/explosion_vertical.png',   35, 35);\n    this.load.spritesheet('explosion_up',         'images/game/explosion_up.png',         35, 35);\n    this.load.spritesheet('explosion_right',      'images/game/explosion_right.png',      35, 35);\n    this.load.spritesheet('explosion_down',       'images/game/explosion_down.png',       35, 35);\n    this.load.spritesheet('explosion_left',       'images/game/explosion_left.png',       35, 35);\n\n    this.load.spritesheet('spoil_tileset', 'images/game/spoil_tileset.png', 35, 35);\n    this.load.spritesheet('bone_tileset',  'images/game/bone_tileset.png', 35, 35);\n    this.load.spritesheet('bomb_tileset',  'images/game/bombs.png', 35, 35);\n\n    this.load.image('speed_up_bonus',    'images/game/speed_up_bonus.png');\n    this.load.image('speed_up_no_bonus', 'images/game/speed_up_no_bonus.png');\n    this.load.image('delay_up_bonus',    'images/game/delay_up_bonus.png');\n    this.load.image('delay_up_no_bonus', 'images/game/delay_up_no_bonus.png');\n    this.load.image('power_up_bonus',    'images/game/power_up_bonus.png');\n\n    this.load.image('placeholder_power', 'images/game/placeholder_power.png');\n    this.load.image('placeholder_speed', 'images/game/placeholder_speed.png');\n    this.load.image('placeholder_time',  'images/game/placeholder_time.png');\n\n    // Special tiles FX\n    this.load.spritesheet('portal_fx', 'images/game/portal_fx.png', 35, 35);\n    this.load.spritesheet('speed_fx',  'images/game/speed_fx.png', 35, 35);\n    this.load.image('ghost_icon', 'images/game/ghost_icon.png');\n\n    // SFX / BGM (mobile may require user gesture to unlock audio)\n    this.load.audio('sfx_portal',    ['sfx/portal.wav']);\n    this.load.audio('sfx_speed',     ['sfx/speed.wav']);\n    this.load.audio('sfx_explosion', ['sfx/explosion.wav']);\n    this.load.audio('sfx_death',     ['sfx/death.wav']);\n    this.load.audio('bgm_main',      ['sfx/bgm.wav']);\n\n    // Cosmetics (paper-doll overlays)\n    for (let i = 1; i <= 5; i++) {\n      this.load.image(`cosmetic_hat_${i}`, `images/game/cosmetics/hat_${i}.png`);\n      this.load.image(`cosmetic_hair_${i}`, `images/game/cosmetics/hair_${i}.png`);\n      this.load.image(`cosmetic_outfit_${i}`, `images/game/cosmetics/outfit_${i}.png`);\n    }\n\n    // Skins:\n    this.load.image('bomberman_head_blank',     'images/game/chars/0-face.png');\n\n    this.load.image('bomberman_head_Theodora',  'images/game/chars/1-face.png');\n    this.load.image('bomberman_head_Ringo',     'images/game/chars/2-face.png');\n    this.load.image('bomberman_head_Jeniffer',  'images/game/chars/3-face.png');\n    this.load.image('bomberman_head_Godard',    'images/game/chars/4-face.png');\n    this.load.image('bomberman_head_Biarid',    'images/game/chars/5-face.png');\n    this.load.image('bomberman_head_Solia',     'images/game/chars/6-face.png');\n    this.load.image('bomberman_head_Kedan',     'images/game/chars/7-face.png');\n    this.load.image('bomberman_head_Nigob',     'images/game/chars/8-face.png');\n    this.load.image('bomberman_head_Baradir',   'images/game/chars/9-face.png');\n    this.load.image('bomberman_head_Raviel',    'images/game/chars/10-face.png');\n    this.load.image('bomberman_head_Valpo',     'images/game/chars/11-face.png');\n\n    this.load.spritesheet('bomberman_Theodora',  'images/game/chars/1-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Ringo',     'images/game/chars/2-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Jeniffer',  'images/game/chars/3-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Godard',    'images/game/chars/4-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Biarid',    'images/game/chars/5-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Solia',     'images/game/chars/6-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Kedan',     'images/game/chars/7-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Nigob',     'images/game/chars/8-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Baradir',   'images/game/chars/9-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Raviel',    'images/game/chars/10-preview.png', 32, 32);\n    this.load.spritesheet('bomberman_Valpo',     'images/game/chars/11-preview.png', 32, 32);\n  }\n\n  create() {\n    // Hide loading overlay\n    try { if (window.UK01Loading) window.UK01Loading.done(); } catch (_) {}\n    this.state.start('Menu');\n  }\n}\n\nexport default Preload;\n","import { Text, TextButton, GameSlots } from '../helpers/elements';\n\nclass Menu extends Phaser.State {\n\n  init() {\n    this.slotsWithGame = null;\n\n    clientSocket.on('display pending games', this.displayPendingGames.bind(this));\n  }\n\n  create() {\n    // Keep the background so the canvas isn't blank behind HTML overlay\n    let background = this.add.image(this.game.world.centerX, this.game.world.centerY, 'main_menu');\n    background.anchor.setTo(0.5);\n\n    // Use HTML overlay for mobile reliability\n    try {\n      if (window.UK01Menu && window.UK01Menu.showMenu) {\n        window.UK01Menu.showMenu();\n      }\n    } catch (_) {}\n\n    clientSocket.emit('enter lobby', this.displayPendingGames.bind(this));\n  }\n\n  update() {\n  }\n\n  hostGameAction() {\n    clientSocket.emit('leave lobby');\n    this.state.start('SelectMap');\n  }\n\n  displayPendingGames(availableGames) {\n    // NOTE: That is not optimal way to preview slots,\n    //       we should implement AddSlotToGroup, RemoveSlotFromGroup\n\n    // I triying to care about readability, not about performance.\n    if (this.slotsWithGame) {\n      this.slotsWithGame.destroy()\n    }\n\n    this.slotsWithGame = new GameSlots({\n      game: this.game,\n      availableGames: availableGames,\n      callback: this.joinGameAction,\n      callbackContext: this,\n      x: this.game.world.centerX - 220,\n      y: 160,\n      style: {\n        font: '35px Areal',\n        fill: '#efefef',\n        stroke: '#ae743a',\n        strokeThickness: 3\n      }\n    })\n  }\n\n  joinGameAction(game_id) {\n    clientSocket.emit('leave lobby');\n    // https://phaser.io/docs/2.6.2/Phaser.StateManager.html#start\n    this.state.start('PendingGame', true, false, game_id);\n  }\n}\n\nexport default Menu;\n","export const AVAILABLE_MAPS = ['hot_map', 'cold_map', 'arena_map', 'open_map', 'rune_lab', 'mirror_temple', 'trap_garden']\nexport const TILESET = 'tiles';\nexport const LAYER   = 'Blocks';\n\nexport const TILE_SIZE = 35;\n\n// Special floor tiles (must not be in collisionTiles)\nexport const TILE_PORTAL = 2;\nexport const TILE_SPEED_FLOOR = 3;\nexport const EXPLOSION_TIME = 2000;\nexport const PING = 100;\n\nexport const SPEED = 0\nexport const POWER = 1\nexport const DELAY = 2\nexport const SHIELD = 3\nexport const REMOTE = 4\nexport const KICK = 5\nexport const GHOST = 6\n\nexport const SHIELD_DURATION_MS = 1500\nexport const GHOST_DURATION_MS = 4500\n\nexport const INITIAL_SPEED = 150\nexport const STEP_SPEED = 50\nexport const MAX_SPEED = 350\nexport const INITIAL_DELAY = 2000\nexport const STEP_DELAY = 500\nexport const MIN_DELAY = 500\nexport const INITIAL_POWER = 1\nexport const STEP_POWER = 1\n","import { AVAILABLE_MAPS } from '../utils/constants';\nimport { Text, Button } from '../helpers/elements';\n\nclass SelectMap extends Phaser.State {\n\n  init() {\n    this.slider = new phaseSlider(this);\n  }\n\n  create() {\n    // Select map is handled by HTML overlay now.\n    // Keep background to avoid blank canvas and immediately return to Menu.\n    let background = this.add.image(this.game.world.centerX, this.game.world.centerY, 'main_menu');\n    background.anchor.setTo(0.5);\n\n    try {\n      if (window.UK01Menu && window.UK01Menu.showMaps) {\n        window.UK01Menu.showMaps();\n      }\n    } catch (_) {}\n\n    // no-op\n  }\n\n  confirmStageSelection() {\n    let map_name = AVAILABLE_MAPS[this.slider.getCurrentIndex()]\n\n    clientSocket.emit('create game', map_name, this.joinToNewGame.bind(this));\n  }\n\n  joinToNewGame(payload) {\n    // server callback may return either a plain id string or an object { game_id }\n    if (payload && payload.error) {\n      // Minimal UX: browser alert (works in Phaser environment)\n      alert(payload.message || payload.error);\n      return;\n    }\n\n    const game_id = (payload && payload.game_id) ? payload.game_id : payload;\n    this.state.start('PendingGame', true, false, game_id);\n  }\n}\n\nexport default SelectMap;\n","import { Text, Button, TextButton, PlayerSlots } from '../helpers/elements';\n\nclass PendingGame extends Phaser.State {\n\n  init(payload) {\n    this.slotsWithPlayer = null;\n\n    // Phaser may pass init params as a plain value (game_id) or as an object { game_id }\n    this.game_id = (payload && payload.game_id) ? payload.game_id : payload;\n\n    clientSocket.on('update game', this.displayGameInfo.bind(this));\n    clientSocket.on('launch game', this.launchGame.bind(this));\n\n    clientSocket.emit('enter pending game', { game_id: this.game_id });\n  }\n\n  create() {\n    let background = this.add.image(this.game.world.centerX, this.game.world.centerY, 'main_menu');\n    background.anchor.setTo(0.5);\n\n    // Use HTML overlay for mobile reliability\n    try {\n      if (window.UK01Pending && window.UK01Pending.show) {\n        window.UK01Pending.show();\n      }\n      // hide main menu overlay if visible\n      if (window.UK01Menu && window.UK01Menu.hideMenu) {\n        window.UK01Menu.hideMenu();\n      }\n    } catch (_) {}\n\n    // keep minimal title text in canvas (optional)\n    this.gameTitle = new Text({\n      game: this.game,\n      x: this.game.world.centerX,\n      y: this.game.world.centerY - 215,\n      text: '',\n      style: {\n        font: '35px Areal',\n        fill: '#9ec0ba',\n        stroke: '#6f7975',\n        strokeThickness: 3\n      }\n    })\n  }\n\n  setAICount(n) {\n    this.aiCount = Math.max(0, Math.min(3, n));\n    if (this.aiText) this.aiText.text = `AI: ${this.aiCount}`;\n\n    clientSocket.emit('set ai count', { count: this.aiCount });\n  }\n\n  setAIDifficulty(difficulty) {\n    this.aiDifficulty = difficulty;\n    if (this.aiDiffText) this.aiDiffText.text = `難度: ${this.aiDifficulty}`;\n\n    clientSocket.emit('set ai difficulty', { difficulty: this.aiDifficulty });\n  }\n\n  displayGameInfo({ current_game }) {\n    let players = Object.values(current_game.players);\n\n    this.gameTitle.text = current_game.name\n\n    if (this.slotsWithPlayer) {\n      this.slotsWithPlayer.destroy()\n    }\n\n    this.slotsWithPlayer = new PlayerSlots({\n      game: this.game,\n      max_players: current_game.max_players,\n      players: players,\n      x: this.game.world.centerX - 245,\n      y: this.game.world.centerY - 80,\n      asset_empty: 'bomberman_head_blank',\n      asset_player: 'bomberman_head_',\n      style: {\n        font: '20px Areal',\n        fill: '#48291c'\n      }\n    })\n\n    // Update HTML overlay\n    try {\n      if (window.UK01Pending && window.UK01Pending.updateFromGame) {\n        window.UK01Pending.updateFromGame(current_game);\n      }\n    } catch (_) {}\n  }\n\n  leaveGameAction() {\n    clientSocket.emit('leave pending game');\n\n    this.state.start('Menu');\n  }\n\n  startGameAction() {\n    clientSocket.emit('start game');\n  }\n\n  launchGame(game) {\n    this.state.start('Play', true, false, game);\n  }\n}\n\nexport default PendingGame;\n","export const findFrom = function(id, entities) {\n  for (let entity of entities.children) {\n    if (entity.id !== id) { continue }\n\n    return entity\n  }\n  return null;\n}\n\nexport const findAndDestroyFrom = function(id, entities) {\n  let entity = findFrom(id, entities);\n  if (!entity) { return }\n\n  entity.destroy()\n}\n","export default class Info {\n\n  constructor({ game, player }) {\n    this.game = game;\n    this.player = player;\n\n    this.style    = { font: '14px Arial', fill: '#ffffff', align: 'left' }\n    this.redStyle = { font: '30px Arial', fill: '#ff0044', align: 'center' };\n\n    // HUD group (sticks to camera)\n    this.hud = this.game.add.group();\n    this.hud.fixedToCamera = true;\n\n    let bootsIcon  = new Phaser.Image(this.game, 5, 2, 'placeholder_speed');\n    this.speedText = new Phaser.Text(this.game, 35, 7, this.speedLabel(), this.style);\n    bootsIcon.addChild(this.speedText)\n    this.hud.add(bootsIcon);\n\n    let powerIcon  = new Phaser.Image(this.game, 110, 2, 'placeholder_power');\n    this.powerText = new Phaser.Text(this.game, 35, 7, this.powerLabel(), this.style);\n    powerIcon.addChild(this.powerText)\n    this.hud.add(powerIcon);\n\n    let delayIcon  = new Phaser.Image(this.game, 215, 2, 'placeholder_time');\n    this.delayText = new Phaser.Text(this.game, 35, 7, this.delayLabel(), this.style);\n    delayIcon.addChild(this.delayText)\n    this.hud.add(delayIcon);\n\n    // Ghost powerup indicator (hidden unless active)\n    let ghostIcon = new Phaser.Image(this.game, 320, 2, 'ghost_icon');\n    ghostIcon.alpha = 0.85;\n    this.ghostText = new Phaser.Text(this.game, 35, 7, '', this.style);\n    ghostIcon.addChild(this.ghostText);\n    ghostIcon.visible = false;\n    this.ghostIcon = ghostIcon;\n    this.hud.add(ghostIcon);\n\n    this._ghostTimer = null;\n\n    this.deadText = this.game.add.text(this.game.world.centerX, this.game.world.height - 30, 'You died :(', this.redStyle);\n    this.deadText.anchor.set(0.5);\n    this.deadText.visible = false;\n    this.deadText.fixedToCamera = true;\n  }\n\n  refreshStatistic() {\n    this.speedText.text = this.speedLabel();\n    this.powerText.text = this.powerLabel();\n    this.delayText.text = this.delayLabel();\n  }\n\n  showGhost(ghostUntilMs) {\n    if (!this.ghostIcon) return;\n\n    this.ghostIcon.visible = true;\n\n    if (this._ghostTimer) {\n      try { this.game.time.events.remove(this._ghostTimer); } catch (_) {}\n      this._ghostTimer = null;\n    }\n\n    const tick = () => {\n      const left = Math.max(0, ghostUntilMs - this.game.time.now);\n      this.ghostText.text = `${(left / 1000).toFixed(1)}s`;\n\n      if (left <= 0) {\n        this.hideGhost();\n      }\n    };\n\n    tick();\n    this._ghostTimer = this.game.time.events.loop(150, tick);\n  }\n\n  hideGhost() {\n    if (this.ghostIcon) this.ghostIcon.visible = false;\n    if (this._ghostTimer) {\n      try { this.game.time.events.remove(this._ghostTimer); } catch (_) {}\n      this._ghostTimer = null;\n    }\n  }\n\n  showDeadInfo() {\n    this.deadText.visible = true\n  }\n\n  speedLabel() {\n    return this.player.speed\n  }\n\n  powerLabel() {\n    return `x ${this.player.power}`\n  }\n\n  delayLabel() {\n    return `${this.player.delay / 1000} sec.`\n  }\n}\n","import {\n  PING, TILE_SIZE, MAX_SPEED, STEP_SPEED, INITIAL_SPEED, SPEED, POWER, DELAY,\n  MIN_DELAY, STEP_DELAY, INITIAL_DELAY, INITIAL_POWER, STEP_POWER,\n  SHIELD, REMOTE, KICK, GHOST, SHIELD_DURATION_MS, GHOST_DURATION_MS\n} from '../utils/constants';\n\nimport Info from './info';\nimport { SpoilNotification, Text } from '../helpers/elements';\n\nexport default class Player extends Phaser.Sprite {\n\n  constructor({ game, id, spawn, skin, avatarParts }) {\n    super(game, spawn.x, spawn.y, 'bomberman_' + skin);\n\n    this.game = game;\n    this.id = id;\n\n    this.prevPosition = { x: spawn.x, y: spawn.y };\n\n    this.delay = INITIAL_DELAY;\n    this.power = INITIAL_POWER;\n    this.speed = INITIAL_SPEED;\n    this.tileSpeedMultiplier = 1.0;\n    this._lastBombTime = 0;\n\n    // powerups\n    this.shieldUntil = 0;\n    this.ghostUntil = 0;\n    this.hasRemote = false;\n    this.hasKick = false;\n\n    this.game.add.existing(this);\n    this.game.physics.arcade.enable(this);\n    this.body.setSize(20, 20, 6, 6);\n\n    // Touch controls state (set by Play state UI)\n    this.touchLeft = false;\n    this.touchRight = false;\n    this.touchUp = false;\n    this.touchDown = false;\n    this.touchBomb = false;\n\n    game.time.events.loop(PING , this.positionUpdaterLoop.bind(this));\n\n    this.animations.add('up', [9, 10, 11], 15, true);\n    this.animations.add('down', [0, 1, 2], 15, true);\n    this.animations.add('right', [6, 7, 8], 15, true);\n    this.animations.add('left', [3, 4, 5], 15, true);\n\n    this.info = new Info({ game: this.game, player: this });\n\n    this.defineKeyboard()\n    this.defineSelf(skin)\n\n    // Paper-doll cosmetics (hair/outfit/hat): simple layered images above base sprite\n    this.avatarParts = avatarParts || null;\n    this.applyAvatarParts(this.avatarParts);\n  }\n\n  update() {\n    if (this.alive) {\n      this.handleMoves()\n      this.handleBombs()\n    }\n\n    // this.game.debug.body(this);\n    // this.game.debug.spriteInfo(this, 32, 32);\n  }\n\n  defineKeyboard() {\n    // Arrow keys\n    this.upKey    = this.game.input.keyboard.addKey(Phaser.Keyboard.UP)\n    this.downKey  = this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN)\n    this.leftKey  = this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT)\n    this.rightKey = this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT)\n\n    // WASD\n    this.wKey = this.game.input.keyboard.addKey(Phaser.Keyboard.W)\n    this.aKey = this.game.input.keyboard.addKey(Phaser.Keyboard.A)\n    this.sKey = this.game.input.keyboard.addKey(Phaser.Keyboard.S)\n    this.dKey = this.game.input.keyboard.addKey(Phaser.Keyboard.D)\n\n    // Bomb\n    this.spaceKey = this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)\n  }\n\n  handleMoves() {\n    this.body.velocity.set(0);\n    let animationsArray = []\n\n    const effectiveSpeed = this.speed * (this.tileSpeedMultiplier || 1.0);\n\n    const left  = this.leftKey.isDown  || (this.aKey && this.aKey.isDown) || this.touchLeft;\n    const right = this.rightKey.isDown || (this.dKey && this.dKey.isDown) || this.touchRight;\n    const up    = this.upKey.isDown    || (this.wKey && this.wKey.isDown) || this.touchUp;\n    const down  = this.downKey.isDown  || (this.sKey && this.sKey.isDown) || this.touchDown;\n\n    if (left){\n      this.body.velocity.x = -effectiveSpeed;\n      animationsArray.push('left')\n    } else if (right) {\n      this.body.velocity.x = effectiveSpeed;\n      animationsArray.push('right')\n    }\n\n    if (up) {\n      this.body.velocity.y = -effectiveSpeed;\n      animationsArray.push('up')\n    } else if (down) {\n      this.body.velocity.y = effectiveSpeed;\n      animationsArray.push('down')\n    }\n\n    let currentAnimation = animationsArray[0]\n    if (currentAnimation){\n      this.animations.play(currentAnimation)\n      return\n    }\n\n    this.animations.stop();\n  }\n\n  handleBombs() {\n    const bombDown = this.game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR) || this.touchBomb;\n\n    if (bombDown) {\n      let now = this.game.time.now;\n\n      if (now > this._lastBombTime) {\n        this._lastBombTime = now + this.delay;\n\n        clientSocket.emit('create bomb', { col: this.currentCol(), row: this.currentRow() });\n      }\n    }\n  }\n\n  currentCol() {\n    return Math.floor(this.body.position.x / TILE_SIZE)\n  }\n\n  currentRow() {\n    return Math.floor(this.body.position.y / TILE_SIZE)\n  }\n\n  positionUpdaterLoop() {\n    let newPosition = { x: this.position.x, y: this.position.y }\n\n    if (this.prevPosition.x !== newPosition.x || this.prevPosition.y !== newPosition.y) {\n      clientSocket.emit('update player position', newPosition);\n      this.prevPosition = newPosition;\n    }\n  }\n\n  becomesDead() {\n    this.info.showDeadInfo()\n    this.kill();\n  }\n\n  pickSpoil( spoil_type ){\n    if ( spoil_type === SPEED ){ this.increaseSpeed() }\n    if ( spoil_type === POWER ){ this.increasePower() }\n    if ( spoil_type === DELAY ){ this.increaseDelay() }\n    if ( spoil_type === SHIELD ){ this.activateShield() }\n    if ( spoil_type === REMOTE ){ this.enableRemote() }\n    if ( spoil_type === KICK ){ this.enableKick() }\n    if ( spoil_type === GHOST ){ this.activateGhost() }\n  }\n\n  isShielded() {\n    return this.shieldUntil && this.game.time.now < this.shieldUntil;\n  }\n\n  isGhosted() {\n    return this.ghostUntil && this.game.time.now < this.ghostUntil;\n  }\n\n  increaseSpeed(){\n    let asset = 'speed_up_no_bonus'\n\n    if (this.speed < MAX_SPEED) {\n      this.speed = this.speed + STEP_SPEED;\n      this.info.refreshStatistic();\n      asset = 'speed_up_bonus'\n    }\n\n    new SpoilNotification({ game: this.game, asset: asset, x: this.position.x, y: this.position.y })\n  }\n\n  increaseDelay(){\n    let asset = 'delay_up_no_bonus'\n\n    if (this.delay > MIN_DELAY){\n      this.delay -= STEP_DELAY;\n      this.info.refreshStatistic();\n      asset = 'delay_up_bonus'\n    }\n\n    new SpoilNotification({ game: this.game, asset: asset, x: this.position.x, y: this.position.y })\n  }\n\n  increasePower(){\n    let asset = 'power_up_bonus'\n\n    this.power += STEP_POWER;\n    this.info.refreshStatistic();\n\n    new SpoilNotification({ game: this.game, asset: asset, x: this.position.x, y: this.position.y })\n  }\n\n  activateShield() {\n    this.shieldUntil = this.game.time.now + SHIELD_DURATION_MS;\n\n    // Simple visual: flash tint while shielded\n    this.tint = 0x66ccff;\n    this.game.time.events.add(SHIELD_DURATION_MS, () => {\n      // If ghost is active, keep ghost visual\n      if (this.isGhosted && this.isGhosted()) {\n        this.tint = 0xa7f7ff;\n        this.alpha = 0.65;\n      } else {\n        this.tint = 0xffffff;\n      }\n    });\n\n    new SpoilNotification({ game: this.game, asset: 'placeholder_time', x: this.position.x, y: this.position.y })\n  }\n\n  enableRemote() {\n    this.hasRemote = true;\n    new SpoilNotification({ game: this.game, asset: 'placeholder_power', x: this.position.x, y: this.position.y })\n  }\n\n  enableKick() {\n    this.hasKick = true;\n    new SpoilNotification({ game: this.game, asset: 'placeholder_speed', x: this.position.x, y: this.position.y })\n  }\n\n  applyAvatarParts(parts) {\n    try {\n      // clear old\n      if (this._cosmetics) {\n        for (const s of this._cosmetics) {\n          try { s.destroy(); } catch (_) {}\n        }\n      }\n      this._cosmetics = [];\n\n      if (!parts) return;\n      const add = (key, x, y, alpha=1) => {\n        if (!key) return;\n        const spr = this.game.add.sprite(x, y, key);\n        spr.anchor.setTo(0.5);\n        spr.alpha = alpha;\n        this.addChild(spr);\n        this._cosmetics.push(spr);\n      };\n\n      // Preloaded as images: cosmetic_hair_X, cosmetic_outfit_X, cosmetic_hat_X\n      const hair = parts.hair ? ('cosmetic_' + parts.hair) : null;\n      const outfit = parts.outfit ? ('cosmetic_' + parts.outfit) : null;\n      const hat = parts.hat ? ('cosmetic_' + parts.hat) : null;\n\n      // offsets tuned for 32x32 preview sprite\n      add(outfit, 16, 18, 0.95);\n      add(hair,   16, 10, 0.98);\n      add(hat,    16, 6,  0.98);\n    } catch (_) {}\n  }\n\n  activateGhost() {\n    this.ghostUntil = this.game.time.now + GHOST_DURATION_MS;\n\n    // Visual: semi-transparent + cool tint\n    this.alpha = 0.65;\n    this.tint = 0xa7f7ff;\n\n    // HUD indicator + countdown\n    if (this.info && this.info.showGhost) {\n      this.info.showGhost(this.ghostUntil);\n    }\n\n    // Clear visual at end (unless shield overwrote tint, reset to white)\n    this.game.time.events.add(GHOST_DURATION_MS, () => {\n      this.alpha = 1;\n      // if shield is still on, keep its tint\n      if (!(this.isShielded && this.isShielded())) {\n        this.tint = 0xffffff;\n      }\n      if (this.info && this.info.hideGhost) {\n        this.info.hideGhost();\n      }\n    });\n\n    new SpoilNotification({ game: this.game, asset: 'ghost_icon', x: this.position.x, y: this.position.y })\n  }\n\n  defineSelf(name) {\n    let playerText = new Text({\n      game: this.game,\n      x: TILE_SIZE / 2,\n      y: -10,\n      text: `\\u272E ${name} \\u272E`,\n      style: {\n        font: '15px Areal',\n        fill: '#FFFFFF',\n          stroke: '#000000',\n          strokeThickness: 3\n      }\n    })\n\n    this.addChild(playerText);\n  }\n}\n","import { TILE_SIZE, PING } from '../utils/constants';\nimport { Text } from '../helpers/elements';\n\nexport default class EnemyPlayer extends Phaser.Sprite {\n\n  constructor({ game, id, spawn, skin }) {\n    super(game, spawn.x, spawn.y, 'bomberman_' + skin);\n\n    this.game = game\n    this.id = id;\n\n    this.currentPosition = spawn;\n    this.lastMoveAt = 0;\n\n    this.game.physics.arcade.enable(this);\n    this.body.setSize(20, 20, 6, 6);\n    this.body.immovable = true;\n\n    this.animations.add('up', [9, 10, 11], 15, true);\n    this.animations.add('down', [0, 1, 2], 15, true);\n    this.animations.add('right', [6, 7, 8], 15, true);\n    this.animations.add('left', [3, 4, 5], 15, true);\n\n    this.defineSelf(skin)\n  }\n\n  update () {\n    // this.game.debug.body(this);\n  }\n\n  goTo(newPosition) {\n    this.lastMoveAt = this.game.time.now;\n\n    this.animateFace(newPosition);\n\n    this.game.add.tween(this).to(newPosition, PING, Phaser.Easing.Linear.None, true);\n  }\n\n  animateFace(newPosition) {\n    let face = 'down';\n    let diffX = newPosition.x - this.currentPosition.x;\n    let diffY = newPosition.y - this.currentPosition.y;\n\n    if (diffX < 0) {\n      face = 'left'\n    } else if (diffX > 0) {\n      face = 'right'\n    } else if (diffY < 0) {\n      face = 'up'\n    } else if (diffY > 0) {\n      face = 'down'\n    }\n\n    this.animations.play(face)\n    this.currentPosition = newPosition;\n  }\n\n  defineSelf(name) {\n    let playerText = new Text({\n      game: this.game,\n      x: TILE_SIZE / 2,\n      y: -10,\n      text: name,\n      style: {\n        font: '14px Areal',\n        fill: '#FFFFFF',\n          stroke: '#000000',\n          strokeThickness: 3\n      }\n    })\n\n    this.addChild(playerText);\n  }\n}\n","import { TILE_SIZE, EXPLOSION_TIME } from '../utils/constants';\n\nexport default class Bomb extends Phaser.Sprite {\n\n  constructor(game, id, col, row) {\n    let centerCol = (col * TILE_SIZE) + TILE_SIZE / 2\n    let centerRow = (row * TILE_SIZE) + TILE_SIZE / 2\n\n    super(game, centerCol, centerRow, 'bomb_tileset');\n    this.scale.setTo(0.7);\n    this.anchor.setTo(0.5);\n\n    this.game = game\n    this.id = id;\n\n    this.game.physics.arcade.enable(this);\n\n    this.game.add.tween(this.scale).to({ x: 1.2, y: 1.2 }, EXPLOSION_TIME, Phaser.Easing.Linear.None, true);\n\n    this.body.immovable = true;\n    // TODO: https://phaser.io/docs/2.4.4/Phaser.AnimationManager.html#add\n    this.animations.add('bomb', [0,1,2,3,4,5,6,7,8,9,10,11,12,13], 6, true);\n    this.animations.play('bomb');\n  }\n\n  update() {\n    // this.game.debug.body(this);\n  }\n\n}\n","import { SPEED, POWER, DELAY, SHIELD, REMOTE, KICK, GHOST, TILE_SIZE } from '../utils/constants';\n\nexport default class Spoil extends Phaser.Sprite {\n\n  constructor(game, spoil) {\n\n    // UK01: spoil_tileset now contains 7 frames (0..6) matching constants\n    let frame = 0;\n    if (spoil.spoil_type === SPEED) frame = 0;\n    if (spoil.spoil_type === POWER) frame = 1;\n    if (spoil.spoil_type === DELAY) frame = 2;\n    if (spoil.spoil_type === SHIELD) frame = 3;\n    if (spoil.spoil_type === REMOTE) frame = 4;\n    if (spoil.spoil_type === KICK) frame = 5;\n    if (spoil.spoil_type === GHOST) frame = 6;\n\n    super(game, (spoil.col * TILE_SIZE), (spoil.row * TILE_SIZE), 'spoil_tileset', frame);\n\n    this.id = spoil.id\n\n    this.game.physics.arcade.enable(this);\n\n    // Light glow/pulse to make spoils more visible (mobile-friendly)\n    this.alpha = 0.92;\n    this.scale.setTo(1.0);\n    try {\n      const t1 = this.game.add.tween(this).to({ alpha: 0.62 }, 420, Phaser.Easing.Sinusoidal.InOut, true, 0, -1, true);\n      const t2 = this.game.add.tween(this.scale).to({ x: 1.08, y: 1.08 }, 520, Phaser.Easing.Sinusoidal.InOut, true, 0, -1, true);\n      // keep refs to avoid GC issues in some Phaser builds\n      this._glowTween = t1;\n      this._scaleTween = t2;\n    } catch (_) {}\n  }\n\n}\n","import { TILE_SIZE } from '../utils/constants';\n\nexport default class FireBlast extends Phaser.Sprite {\n\n  constructor(game, cell) {\n    super(game, (cell.col * TILE_SIZE), (cell.row * TILE_SIZE), cell.type, 0);\n\n    this.game = game\n\n    this.animations.add('blast', [0, 1, 2, 3, 4]);\n\n    // 15 - framerate, loop, kill_on_complete\n    this.play('blast', 15, false, true);\n\n    this.game.physics.arcade.enable(this);\n  }\n\n}\n","import { TILE_SIZE } from '../utils/constants';\n\nexport default class Bone extends Phaser.Sprite {\n\n  constructor(game, col, row) {\n    super(game, (col * TILE_SIZE), (row * TILE_SIZE), 'bone_tileset');\n  }\n\n}\n","import { findFrom, findAndDestroyFrom } from '../utils/utils';\nimport { TILESET, LAYER, TILE_SIZE, TILE_PORTAL, TILE_SPEED_FLOOR } from '../utils/constants';\n\nimport Player from '../entities/player';\nimport EnemyPlayer from '../entities/enemy_player';\nimport Bomb from '../entities/bomb';\nimport Spoil from '../entities/spoil';\nimport FireBlast from '../entities/fire_blast';\nimport Bone from '../entities/bone';\n\nclass Play extends Phaser.State {\n  init(game) {\n    this.currentGame = game\n  }\n\n  create() {\n    this.createMap();\n    this.createPlayers();\n    this.setEventHandlers();\n\n    // Keep player in view on mobile / resized canvas\n    if (this.player) {\n      this.game.camera.follow(this.player);\n    }\n\n    // hide overlays during gameplay\n    try { if (window.UK01Pending && window.UK01Pending.hide) window.UK01Pending.hide(); } catch (_) {}\n    try { if (window.UK01Menu && window.UK01Menu.hideMenu) window.UK01Menu.hideMenu(); } catch (_) {}\n\n    // Use HTML touch overlay on mobile (works even when canvas is letterboxed)\n    try { if (window.UK01Touch && window.UK01Touch.show) window.UK01Touch.show(); } catch (_) {}\n\n    // Keep Phaser touch controls disabled to avoid double-input on mobile\n    // this.createTouchControls();\n\n    // SFX / BGM\n    this.sfxPortal = this.game.add.audio('sfx_portal');\n    this.sfxSpeed = this.game.add.audio('sfx_speed');\n    this.sfxExplosion = this.game.add.audio('sfx_explosion');\n    this.sfxDeath = this.game.add.audio('sfx_death');\n\n    // Background music (loop)\n    try {\n      if (this.game._bgm && this.game._bgm.stop) {\n        this.game._bgm.stop();\n      }\n      this.game._bgm = this.game.add.audio('bgm_main');\n      this.game._bgm.loop = true;\n      this.game._bgm.volume = 0.18;\n      this.game._bgm.play();\n    } catch (_) {}\n\n    this.game.time.events.loop(400 , this.stopAnimationLoop.bind(this));\n  }\n\n  update() {\n    this.refreshGhostCollision();\n\n    this.game.physics.arcade.collide(this.player, this.blockLayer);\n    this.game.physics.arcade.collide(this.player, this.enemies);\n    this.game.physics.arcade.collide(this.player, this.bombs, this.onPlayerVsBomb, null, this);\n\n    this.game.physics.arcade.overlap(this.player, this.spoils, this.onPlayerVsSpoil, null, this);\n    this.game.physics.arcade.overlap(this.player, this.blasts, this.onPlayerVsBlast, null, this);\n\n    this.handleSpecialTiles();\n  }\n\n  createMap() {\n    this.map = this.add.tilemap(this.currentGame.map_name);\n\n    this.map.addTilesetImage(TILESET);\n\n    this.blockLayer = this.map.createLayer(LAYER);\n    this.blockLayer.resizeWorld();\n\n    this.baseCollisionTiles = (this.blockLayer.layer.properties.collisionTiles || []).slice();\n    this.wallTileIndex = this.blockLayer.layer.properties.wall;\n    this.balkTileIndex = this.blockLayer.layer.properties.balk;\n\n    this.map.setCollision(this.baseCollisionTiles, true, this.blockLayer);\n    this._ghostCollisionEnabled = false;\n\n    // Special tiles cache\n    this.portalCells = [];\n    this.speedCells = new Set();\n\n    // Visual overlays (magic style placeholder)\n    this.specialFx = this.game.add.group();\n\n    const layer = this.map.layers[0];\n    const w = layer.width;\n    const h = layer.height;\n    const data = layer.data;\n\n    for (let r = 0; r < h; r++) {\n      for (let c = 0; c < w; c++) {\n        const tile = data[r][c];\n        if (!tile) continue;\n        const idx = tile.index;\n\n        if (idx === TILE_PORTAL) {\n          this.portalCells.push({ col: c, row: r });\n        } else if (idx === TILE_SPEED_FLOOR) {\n          this.speedCells.add(`${c},${r}`);\n        }\n      }\n    }\n\n    // Special tiles visuals (animated spritesheets)\n    // NOTE: We keep them as a separate group so they sit above the map.\n    for (const p of this.portalCells) {\n      const x = p.col * TILE_SIZE;\n      const y = p.row * TILE_SIZE;\n      const s = this.game.add.sprite(x, y, 'portal_fx');\n      s.alpha = 0.95;\n      s.blendMode = Phaser.blendModes.ADD;\n      s.animations.add('spin', [0, 1, 2, 3, 4, 5], 10, true);\n      s.animations.play('spin');\n      this.specialFx.add(s);\n    }\n\n    for (const key of this.speedCells) {\n      const [c, r] = key.split(',').map(Number);\n      const x = c * TILE_SIZE;\n      const y = r * TILE_SIZE;\n      const s = this.game.add.sprite(x, y, 'speed_fx');\n      s.alpha = 0.75;\n      s.animations.add('flow', [0, 1, 2, 3, 4, 5], 12, true);\n      s.animations.play('flow');\n      this.specialFx.add(s);\n    }\n\n    this.player  = null;\n    this.bones   = this.game.add.group();\n    this.bombs   = this.game.add.group();\n    this.spoils  = this.game.add.group();\n    this.blasts  = this.game.add.group();\n    this.enemies = this.game.add.group();\n\n    this.game.physics.arcade.enable(this.blockLayer);\n  }\n\n  createPlayers() {\n    const all = Object.values(this.currentGame.players || {});\n\n    // Prefer socket id match\n    let local = all.find(p => p && p.id === clientSocket.id);\n\n    // Fallback: match by authenticated userId (useful if socket id changed)\n    if (!local) {\n      try {\n        const uid = window.currentUser && window.currentUser.id;\n        if (uid) {\n          local = all.find(p => p && p.userId && p.userId === uid);\n        }\n      } catch (_) {}\n    }\n\n    for (let player of all) {\n      if (!player) continue;\n      let setup = {\n        game:   this.game,\n        id:     player.id,\n        spawn:  player.spawn,\n        skin:   player.skin,\n        avatarParts: player.avatarParts || null,\n      }\n\n      if ((local && player === local) || player.id === clientSocket.id) {\n        this.player = new Player(setup);\n      } else {\n        this.enemies.add(new EnemyPlayer(setup))\n      }\n    }\n\n    // If still not found (anonymous + mismatch), pick first non-bot as local to avoid a blank screen\n    if (!this.player && all.length) {\n      const first = all.find(p => p && !(typeof p.id === 'string' && p.id.startsWith('bot:'))) || all[0];\n      if (first) {\n        this.player = new Player({ game: this.game, id: first.id, spawn: first.spawn, skin: first.skin, avatarParts: first.avatarParts || null });\n      }\n    }\n  }\n\n  setEventHandlers() {\n    clientSocket.on('move player', this.onMovePlayer.bind(this));\n    clientSocket.on('player win', this.onPlayerWin.bind(this));\n    clientSocket.on('show bomb', this.onShowBomb.bind(this));\n    clientSocket.on('detonate bomb', this.onDetonateBomb.bind(this));\n    clientSocket.on('move bomb', this.onMoveBomb.bind(this));\n    clientSocket.on('spoil was picked', this.onSpoilWasPicked.bind(this));\n    clientSocket.on('show bones', this.onShowBones.bind(this));\n    clientSocket.on('player disconnect', this.onPlayerDisconnect.bind(this));\n    clientSocket.on('sudden death tiles', this.onSuddenDeathTiles.bind(this));\n  }\n\n  onPlayerVsSpoil(player, spoil) {\n    clientSocket.emit('pick up spoil', { spoil_id: spoil.id });\n    spoil.kill();\n  }\n\n  onPlayerVsBlast(player, blast) {\n    if (!player.alive) return;\n    // Shield powerup: brief invulnerability\n    if (player.isShielded && player.isShielded()) return;\n\n    try { if (this.sfxDeath) this.sfxDeath.play(); } catch (_) {}\n\n    clientSocket.emit('player died', { col: player.currentCol(), row: player.currentRow() });\n    player.becomesDead()\n  }\n\n  onMovePlayer({ player_id, x, y }) {\n    let enemy = findFrom(player_id, this.enemies);\n    if (!enemy) { return }\n\n    enemy.goTo({ x: x, y: y })\n  }\n\n  onPlayerVsBomb(player, bomb) {\n    if (!player || !bomb) return;\n    if (!player.hasKick) return;\n\n    // Determine movement direction intent (keyboard + touch)\n    const left  = player.leftKey.isDown  || (player.aKey && player.aKey.isDown) || player.touchLeft;\n    const right = player.rightKey.isDown || (player.dKey && player.dKey.isDown) || player.touchRight;\n    const up    = player.upKey.isDown    || (player.wKey && player.wKey.isDown) || player.touchUp;\n    const down  = player.downKey.isDown  || (player.sKey && player.sKey.isDown) || player.touchDown;\n\n    let dir = null;\n    if (left) dir = 'left';\n    else if (right) dir = 'right';\n    else if (up) dir = 'up';\n    else if (down) dir = 'down';\n\n    if (!dir) return;\n\n    // Throttle: avoid spamming server every physics tick\n    const now = this.game.time.now;\n    if (!player._lastKickAt) player._lastKickAt = 0;\n    if (now - player._lastKickAt < 110) return;\n    player._lastKickAt = now;\n\n    clientSocket.emit('kick bomb', { bomb_id: bomb.id, dir });\n  }\n\n  onMoveBomb({ bomb_id, col, row }) {\n    const b = findFrom(bomb_id, this.bombs);\n    if (!b) return;\n\n    const x = (col * TILE_SIZE) + TILE_SIZE / 2;\n    const y = (row * TILE_SIZE) + TILE_SIZE / 2;\n    b.x = x;\n    b.y = y;\n    if (b.body) {\n      b.body.reset(x, y);\n    }\n  }\n\n  stopAnimationLoop() {\n    for (let enemy of this.enemies.children) {\n      if (enemy.lastMoveAt < this.game.time.now - 200) {\n        enemy.animations.stop();\n      }\n    }\n  }\n\n  createTouchControls() {\n    if (!this.player) return;\n\n    // Only show on touch-capable devices (Phaser detection can be flaky on some mobile browsers)\n    const isTouchCapable = (\n      (this.game.device && (this.game.device.touch || this.game.device.iOS || this.game.device.android)) ||\n      (typeof window !== 'undefined' && ('ontouchstart' in window)) ||\n      (typeof navigator !== 'undefined' && (navigator.maxTouchPoints > 0))\n    );\n    if (!isTouchCapable) return;\n\n    const g = this.game.add.group();\n    g.fixedToCamera = true;\n    g.cameraOffset.setTo(0, 0);\n\n    const mkBtn = ({ x, y, r = 44, label, onDown, onUp, fill = 0x111111, alpha = 0.35, stroke = 0xffffff, strokeAlpha = 0.22 }) => {\n      const btn = this.game.add.graphics(0, 0);\n      btn.beginFill(fill, alpha);\n      btn.lineStyle(3, stroke, strokeAlpha);\n      btn.drawCircle(0, 0, r * 2);\n      btn.endFill();\n      btn.x = x;\n      btn.y = y;\n\n      const t = this.game.add.text(0, 0, label, { font: '26px Arial', fill: '#ffffff' });\n      t.anchor.setTo(0.5);\n      btn.addChild(t);\n\n      btn.inputEnabled = true;\n      btn.events.onInputDown.add(() => onDown && onDown());\n      const up = () => onUp && onUp();\n      btn.events.onInputUp.add(up);\n      btn.events.onInputOut.add(up);\n\n      g.add(btn);\n      return btn;\n    };\n\n    const w = this.game.width;\n    const h = this.game.height;\n\n    // iOS/Android safe-area padding (home indicator / browser UI)\n    const cssSafeBottom = (() => {\n      try {\n        const v = getComputedStyle(document.documentElement).getPropertyValue('env(safe-area-inset-bottom)');\n        const n = parseInt((v || '0').toString().replace('px', '').trim(), 10);\n        return Number.isFinite(n) ? n : 0;\n      } catch (_) {\n        return 0;\n      }\n    })();\n\n    const padBottom = Math.max(28, cssSafeBottom + 18);\n\n    // Scale controls a bit based on screen size\n    const s = Math.max(0.85, Math.min(1.15, Math.min(w, h) / 700));\n\n    // Virtual joystick (4-direction snap)\n    const baseX = 125 * s;\n    const baseY = h - (185 * s) - padBottom;\n    const baseR = 70 * s;\n    const knobR = 36 * s;\n\n    const base = this.game.add.graphics(0, 0);\n    base.beginFill(0x111111, 0.22);\n    base.lineStyle(3, 0xffffff, 0.18);\n    base.drawCircle(0, 0, baseR * 2);\n    base.endFill();\n    base.x = baseX;\n    base.y = baseY;\n    base.inputEnabled = true;\n    base.input.enableDrag(false);\n    g.add(base);\n\n    const knob = this.game.add.graphics(0, 0);\n    knob.beginFill(0x00e5ff, 0.18);\n    knob.lineStyle(3, 0x00e5ff, 0.25);\n    knob.drawCircle(0, 0, knobR * 2);\n    knob.endFill();\n    knob.x = baseX;\n    knob.y = baseY;\n    g.add(knob);\n\n    const resetDir = () => {\n      this.player.touchLeft = this.player.touchRight = this.player.touchUp = this.player.touchDown = false;\n    };\n\n    const setDirFromVector = (dx, dy) => {\n      resetDir();\n      const dead = 14;\n      if (Math.abs(dx) < dead && Math.abs(dy) < dead) {\n        knob.x = baseX;\n        knob.y = baseY;\n        return;\n      }\n\n      // snap to 4 directions\n      if (Math.abs(dx) > Math.abs(dy)) {\n        if (dx > 0) this.player.touchRight = true;\n        else this.player.touchLeft = true;\n        knob.x = baseX + Math.max(-baseR + knobR, Math.min(baseR - knobR, dx));\n        knob.y = baseY;\n      } else {\n        if (dy > 0) this.player.touchDown = true;\n        else this.player.touchUp = true;\n        knob.x = baseX;\n        knob.y = baseY + Math.max(-baseR + knobR, Math.min(baseR - knobR, dy));\n      }\n    };\n\n    const onPointer = (pointer) => {\n      const dx = pointer.x - baseX;\n      const dy = pointer.y - baseY;\n      const len = Math.sqrt(dx * dx + dy * dy) || 1;\n      const max = baseR - knobR;\n      const clamped = Math.min(max, len);\n      const ndx = (dx / len) * clamped;\n      const ndy = (dy / len) * clamped;\n      setDirFromVector(ndx, ndy);\n    };\n\n    base.events.onInputDown.add((sprite, pointer) => onPointer(pointer));\n    base.events.onInputUp.add(() => { resetDir(); knob.x = baseX; knob.y = baseY; });\n    base.events.onInputOut.add(() => { resetDir(); knob.x = baseX; knob.y = baseY; });\n\n    // Track drag/move globally while pressed\n    this.game.input.addMoveCallback((pointer) => {\n      if (!pointer.isDown) return;\n      onPointer(pointer);\n    }, this);\n\n    // Bomb button (right side)\n    mkBtn({\n      x: w - (115 * s),\n      y: h - (165 * s) - padBottom,\n      r: 54 * s,\n      label: '💣',\n      fill: 0x7a1cff,\n      alpha: 0.32,\n      stroke: 0x00e5ff,\n      strokeAlpha: 0.35,\n      onDown: () => (this.player.touchBomb = true),\n      onUp: () => (this.player.touchBomb = false),\n    });\n\n    // Reposition on resize (RESIZE scale mode)\n    this.game.scale.onSizeChange.add(() => {\n      const w2 = this.game.width;\n      const h2 = this.game.height;\n      // update camera-fixed positions by moving the whole group\n      // easiest: clear & recreate\n      g.destroy(true);\n      this.createTouchControls();\n    });\n  }\n\n  onSuddenDeathTiles({ level, tiles }) {\n    if (!tiles || !tiles.length) return;\n\n    // Visual: place walls on map; keep collision as-is (walls are already collidable)\n    const wallIdx = this.wallTileIndex;\n    for (const t of tiles) {\n      try {\n        this.map.putTile(wallIdx, t.col, t.row, this.blockLayer);\n      } catch (_) {}\n    }\n\n    // Optional: show a tiny hint\n    try {\n      if (!this._sdText) {\n        this._sdText = this.game.add.text(10, 10, '', { font: '16px Arial', fill: '#ffdf7a', stroke: '#000', strokeThickness: 3 });\n        this._sdText.fixedToCamera = true;\n      }\n      this._sdText.text = `SUDDEN DEATH Lv.${level}`;\n      this.game.time.events.add(1200, () => { try { if (this._sdText) this._sdText.text = ''; } catch (_) {} });\n    } catch (_) {}\n  }\n\n  refreshGhostCollision() {\n    if (!this.player) return;\n\n    const ghost = this.player.isGhosted && this.player.isGhosted();\n    if (ghost === this._ghostCollisionEnabled) return;\n\n    // Ghost: phase through destructible blocks (\"balk\") only.\n    // We keep walls solid.\n    this._ghostCollisionEnabled = ghost;\n\n    if (ghost) {\n      this.map.setCollision([this.wallTileIndex], true, this.blockLayer);\n      if (this.balkTileIndex != null) {\n        this.map.setCollision([this.balkTileIndex], false, this.blockLayer);\n      }\n    } else {\n      this.map.setCollision(this.baseCollisionTiles, true, this.blockLayer);\n    }\n  }\n\n  handleSpecialTiles() {\n    if (!this.player) return;\n\n    const col = Math.floor(this.player.body.position.x / TILE_SIZE);\n    const row = Math.floor(this.player.body.position.y / TILE_SIZE);\n\n    // Speed floor\n    const onSpeed = this.speedCells.has(`${col},${row}`);\n    this.player.tileSpeedMultiplier = onSpeed ? 1.65 : 1.0;\n\n    if (!this.player._wasOnSpeed) this.player._wasOnSpeed = false;\n    if (onSpeed && !this.player._wasOnSpeed) {\n      try { if (this.sfxSpeed) this.sfxSpeed.play(); } catch (_) {}\n    }\n    this.player._wasOnSpeed = onSpeed;\n\n    // Portal (pair portals in order: 0<->1, 2<->3, ...)\n    if (this.portalCells.length >= 2) {\n      const now = this.game.time.now;\n      if (!this.player._lastPortalAt) this.player._lastPortalAt = 0;\n\n      const portalIndex = this.portalCells.findIndex(p => p.col === col && p.row === row);\n      if (portalIndex >= 0 && now - this.player._lastPortalAt > 900) {\n        const pairIndex = (portalIndex % 2 === 0) ? portalIndex + 1 : portalIndex - 1;\n        const target = this.portalCells[pairIndex];\n        if (target) {\n          // Teleport to tile center\n          this.player.x = target.col * TILE_SIZE;\n          this.player.y = target.row * TILE_SIZE;\n          this.player.body.velocity.set(0);\n          this.player.body.reset(this.player.x, this.player.y);\n          this.player.prevPosition = { x: this.player.x, y: this.player.y };\n          this.player._lastPortalAt = now;\n\n          try { if (this.sfxPortal) this.sfxPortal.play(); } catch (_) {}\n        }\n      }\n    }\n  }\n\n  onShowBomb({ bomb_id, col, row }) {\n    this.bombs.add(new Bomb(this.game, bomb_id, col, row));\n  }\n\n  onDetonateBomb({ bomb_id, blastedCells }) {\n    // Remove Bomb:\n    findAndDestroyFrom(bomb_id, this.bombs)\n\n    try { if (this.sfxExplosion) this.sfxExplosion.play(); } catch (_) {}\n\n    // Render Blast:\n    for (let cell of blastedCells) {\n      this.blasts.add(new FireBlast(this.game, cell));\n    };\n\n    // Destroy Tiles:\n    for (let cell of blastedCells) {\n      if (!cell.destroyed) { continue }\n\n      this.map.putTile(this.blockLayer.layer.properties.empty, cell.col, cell.row, this.blockLayer);\n    };\n\n    // Add Spoils:\n    for (let cell of blastedCells) {\n      if (!cell.destroyed) { continue }\n      if (!cell.spoil) { continue }\n\n      this.spoils.add(new Spoil(this.game, cell.spoil));\n    };\n  }\n\n  onSpoilWasPicked({ player_id, spoil_id, spoil_type }){\n    if (player_id === this.player.id){\n      this.player.pickSpoil(spoil_type)\n    }\n\n    findAndDestroyFrom(spoil_id, this.spoils)\n  }\n\n  onShowBones({ player_id, col, row }) {\n    this.bones.add(new Bone(this.game, col, row));\n\n    findAndDestroyFrom(player_id, this.enemies)\n  }\n\n  onPlayerWin(payload) {\n    try { if (window.UK01Touch && window.UK01Touch.hide) window.UK01Touch.hide(); } catch (_) {}\n    clientSocket.emit('leave game');\n\n    // Backward compatible: server may send a skin string or { skin, player_id, reason }\n    const winner_skin = (payload && payload.skin) ? payload.skin : payload;\n    const reason = (payload && payload.reason) ? payload.reason : null;\n\n    this.state.start('Win', true, false, { skin: winner_skin, reason });\n  }\n\n  onPlayerDisconnect({ player_id }) {\n    findAndDestroyFrom(player_id, this.enemies);\n\n    if (this.enemies.children.length >= 1) { return }\n\n    this.onPlayerWin()\n  }\n}\n\nexport default Play;\n","import { Text } from '../helpers/elements';\n\nclass Win extends Phaser.State {\n\n  init(payload) {\n    // payload may be a string skin or { skin, reason }\n    if (payload && typeof payload === 'object') {\n      this.skin = payload.skin;\n      this.reason = payload.reason;\n    } else {\n      this.skin = payload;\n      this.reason = null;\n    }\n  }\n\n  create() {\n    // Hide touch overlay on end screen\n    try { if (window.UK01Touch && window.UK01Touch.hide) window.UK01Touch.hide(); } catch (_) {}\n\n    // Stop BGM on end screen\n    try {\n      const g = this.game;\n      if (g && g._bgm && g._bgm.stop) g._bgm.stop();\n    } catch (_) {}\n\n    new Text({\n      game: this.game,\n      x: this.game.world.centerX,\n      y: this.game.world.centerY,\n      text: this.winnerText(),\n      style: {\n        font: '30px Areal',\n        fill: '#FFFFFF'\n      }\n    })\n\n    // Mobile-friendly: tap anywhere to return\n    try {\n      this.game.input.onTap.addOnce(() => this.returnToMenu());\n    } catch (_) {}\n\n    // Also allow pointer click\n    try {\n      this.game.input.onDown.addOnce(() => this.returnToMenu());\n    } catch (_) {}\n\n    // Auto return after a short delay (avoid getting stuck)\n    try {\n      this.game.time.events.add(3500, () => this.returnToMenu());\n    } catch (_) {}\n  }\n\n  update() {\n    if( this.game.input.keyboard.isDown(Phaser.Keyboard.ENTER) ) {\n      this.returnToMenu();\n    }\n  }\n\n  returnToMenu() {\n    this.state.start('Menu');\n  }\n\n  winnerText() {\n    if (this.skin) {\n      const why = this.reason ? ` (reason: ${this.reason})` : '';\n      return `Player: \"${this.skin}\" won!${why} Tap to return to main menu.`\n    }\n\n    return 'Opponent left! Tap to return to main menu.'\n  }\n}\n\nexport default Win;\n","import Boot from './states/boot';\nimport Preload from './states/preload';\nimport Menu from './states/menu';\nimport SelectMap from './states/select_map';\nimport PendingGame from './states/pending_game';\nimport Play from './states/play';\nimport Win from './states/win';\n\nclass Game extends Phaser.Game {\n  constructor() {\n    // Use a fixed logical resolution; CSS + ScaleManager will scale to fit mobile screens.\n    // Map size is 28x18 tiles at 35px => 980x630.\n    super(980, 630, Phaser.AUTO, 'game-container');\n\n    // Tell Phaser to use setTimeOut even if RAF(request animation frame) is available.\n    this.config['forceSetTimeOut'] = true\n\n    this.state.add('Boot',         Boot);\n    this.state.add('Preload',      Preload);\n    this.state.add('Menu',         Menu);\n    this.state.add('SelectMap',    SelectMap);\n    this.state.add('PendingGame',  PendingGame);\n    this.state.add('Play',         Play);\n    this.state.add('Win',          Win);\n\n    this.state.start('Boot');\n  }\n}\n\n// keep a reference for HTML overlay to control states\nwindow.__phaserGame = new Game();\n"],"names":["Text","Phaser","constructor","game","x","y","text","style","super","this","anchor","setTo","add","existing","Button","GameSlots","Group","availableGames","callback","callbackContext","yOffset","availableGame","gameBox","Image","button","width","bind","game_id","id","name","addChild","destroy","callAll","PlayerSlots","max_players","players","asset_empty","asset_player","xOffset","i","slotBox","slotName","_player","skin","height","SpoilNotification","asset","picture","tween","to","alpha","onComplete","finish","start","Boot","State","create","stage","disableVisibilityChange","scale","scaleMode","ScaleManager","SHOW_ALL","pageAlignHorizontally","pageAlignVertically","refresh","_","window","addEventListener","world","centerX","centerY","font","fill","sound","mute","input","onDown","addOnce","context","state","resume","unlock","Preload","preload","load","onFileError","key","file","UK01Log","url","onFileComplete","progress","UK01Loading","set","onLoadComplete","image","spritesheet","tilemap","Tilemap","TILED_JSON","audio","done","Menu","init","slotsWithGame","clientSocket","on","displayPendingGames","UK01Menu","showMenu","emit","update","hostGameAction","joinGameAction","stroke","strokeThickness","AVAILABLE_MAPS","TILE_SIZE","SelectMap","slider","phaseSlider","showMaps","confirmStageSelection","map_name","getCurrentIndex","joinToNewGame","payload","error","alert","message","PendingGame","slotsWithPlayer","displayGameInfo","launchGame","UK01Pending","show","hideMenu","gameTitle","setAICount","n","aiCount","Math","max","min","aiText","count","setAIDifficulty","difficulty","aiDifficulty","aiDiffText","current_game","Object","values","updateFromGame","leaveGameAction","startGameAction","findFrom","entities","entity","children","findAndDestroyFrom","Info","player","align","redStyle","hud","group","fixedToCamera","bootsIcon","speedText","speedLabel","powerIcon","powerText","powerLabel","delayIcon","delayText","delayLabel","ghostIcon","ghostText","visible","_ghostTimer","deadText","refreshStatistic","showGhost","ghostUntilMs","time","events","remove","tick","left","now","toFixed","hideGhost","loop","showDeadInfo","speed","power","delay","Player","Sprite","spawn","avatarParts","prevPosition","tileSpeedMultiplier","_lastBombTime","shieldUntil","ghostUntil","hasRemote","hasKick","physics","arcade","enable","body","setSize","touchLeft","touchRight","touchUp","touchDown","touchBomb","positionUpdaterLoop","animations","info","defineKeyboard","defineSelf","applyAvatarParts","alive","handleMoves","handleBombs","upKey","keyboard","addKey","Keyboard","UP","downKey","DOWN","leftKey","LEFT","rightKey","RIGHT","wKey","W","aKey","A","sKey","S","dKey","D","spaceKey","SPACEBAR","velocity","animationsArray","effectiveSpeed","isDown","right","up","down","push","currentAnimation","play","stop","col","currentCol","row","currentRow","floor","position","newPosition","becomesDead","kill","pickSpoil","spoil_type","increaseSpeed","increasePower","increaseDelay","activateShield","enableRemote","enableKick","activateGhost","isShielded","isGhosted","tint","parts","_cosmetics","s","spr","sprite","hair","outfit","hat","playerText","EnemyPlayer","currentPosition","lastMoveAt","immovable","goTo","animateFace","Easing","Linear","None","face","diffX","diffY","Bomb","Spoil","spoil","frame","t1","Sinusoidal","InOut","t2","_glowTween","_scaleTween","FireBlast","cell","type","Bone","Play","currentGame","createMap","createPlayers","setEventHandlers","camera","follow","hide","UK01Touch","sfxPortal","sfxSpeed","sfxExplosion","sfxDeath","_bgm","volume","stopAnimationLoop","refreshGhostCollision","collide","blockLayer","enemies","bombs","onPlayerVsBomb","overlap","spoils","onPlayerVsSpoil","blasts","onPlayerVsBlast","handleSpecialTiles","map","addTilesetImage","createLayer","resizeWorld","baseCollisionTiles","layer","properties","collisionTiles","slice","wallTileIndex","wall","balkTileIndex","balk","setCollision","_ghostCollisionEnabled","portalCells","speedCells","Set","specialFx","layers","w","h","data","r","c","tile","idx","index","p","blendMode","blendModes","ADD","split","Number","bones","all","local","find","uid","currentUser","userId","setup","length","first","startsWith","onMovePlayer","onPlayerWin","onShowBomb","onDetonateBomb","onMoveBomb","onSpoilWasPicked","onShowBones","onPlayerDisconnect","onSuddenDeathTiles","spoil_id","blast","player_id","enemy","bomb","dir","_lastKickAt","bomb_id","b","reset","createTouchControls","device","touch","iOS","android","navigator","maxTouchPoints","g","cameraOffset","cssSafeBottom","v","getComputedStyle","document","documentElement","getPropertyValue","parseInt","toString","replace","trim","isFinite","padBottom","baseX","baseY","baseR","knobR","base","graphics","beginFill","lineStyle","drawCircle","endFill","inputEnabled","enableDrag","knob","resetDir","setDirFromVector","dx","dy","abs","onPointer","pointer","len","sqrt","clamped","onInputDown","onInputUp","onInputOut","addMoveCallback","mkBtn","label","onUp","strokeAlpha","btn","t","onSizeChange","level","tiles","wallIdx","putTile","_sdText","ghost","onSpeed","has","_wasOnSpeed","_lastPortalAt","portalIndex","findIndex","pairIndex","target","blastedCells","destroyed","empty","winner_skin","reason","Win","winnerText","onTap","returnToMenu","ENTER","why","Game","AUTO","config","__phaserGame"],"sourceRoot":""}